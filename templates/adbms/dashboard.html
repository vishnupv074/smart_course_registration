{% extends 'base.html' %}

{% block title %}ADBMS Demos - SmartReg{% endblock %}

{% block extra_css %}
<style>
    .page-header {
        background: linear-gradient(135deg, var(--success) 0%, var(--secondary) 100%);
        color: white;
        padding: 3rem 0;
        margin: -2rem -15px 2.5rem;
        border-radius: 0 0 var(--radius-2xl) var(--radius-2xl);
    }

    .demo-card {
        height: 100%;
        transition: all var(--transition-base);
        cursor: pointer;
        border: 2px solid var(--border-color);
    }

    .demo-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-xl);
        border-color: transparent;
    }

    .demo-card.category-isolation {
        border-top: 4px solid var(--info);
    }

    .demo-card.category-concurrency {
        border-top: 4px solid var(--warning);
    }

    .demo-card.category-performance {
        border-top: 4px solid var(--primary-start);
    }

    .demo-icon {
        width: 60px;
        height: 60px;
        border-radius: var(--radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.75rem;
        margin-bottom: 1rem;
    }

    .demo-icon.icon-isolation {
        background: linear-gradient(135deg, var(--info) 0%, var(--info-light) 100%);
        color: white;
    }

    .demo-icon.icon-concurrency {
        background: linear-gradient(135deg, var(--warning) 0%, var(--warning-light) 100%);
        color: white;
    }

    .demo-icon.icon-performance {
        background: var(--primary-gradient);
        color: white;
    }

    .demo-title {
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: var(--text-primary);
    }

    .demo-subtitle {
        font-size: 0.875rem;
        color: var(--text-tertiary);
        margin-bottom: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .demo-description {
        color: var(--text-secondary);
        font-size: 0.95rem;
    }

    .category-header {
        margin-top: 2rem;
        margin-bottom: 1.5rem;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid var(--border-color);
    }

    .category-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: var(--radius-md);
        margin-right: 0.75rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header text-center">
    <div class="container">
        <h1 class="mb-3">
            <i class="fas fa-database me-2"></i>ADBMS Demonstrations
        </h1>
        <p class="mb-0 opacity-75">
            Explore interactive demonstrations of advanced database management concepts
        </p>
    </div>
</div>

<!-- Isolation Levels -->
<div class="category-header">
    <h3>
        <span class="category-icon"
            style="background: linear-gradient(135deg, var(--info) 0%, var(--info-light) 100%); color: white;">
            <i class="fas fa-layer-group"></i>
        </span>
        Transaction Isolation Levels
    </h3>
</div>

<div class="row g-4 mb-4">
    <div class="col-md-6">
        <a href="{% url 'non-repeatable-read' %}" class="text-decoration-none">
            <div class="card demo-card category-isolation hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-isolation">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <h4 class="demo-title">Non-Repeatable Read</h4>
                    <p class="demo-subtitle">Read Committed</p>
                    <p class="demo-description">
                        Demonstrates how reading the same row twice in a transaction yields different results if another
                        transaction commits a change in between.
                    </p>
                    <div class="mt-3">
                        <span class="badge bg-info">Isolation Level Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6">
        <a href="{% url 'phantom-read' %}" class="text-decoration-none">
            <div class="card demo-card category-isolation hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-isolation">
                        <i class="fas fa-ghost"></i>
                    </div>
                    <h4 class="demo-title">Phantom Read</h4>
                    <p class="demo-subtitle">Repeatable Read</p>
                    <p class="demo-description">
                        Shows how a range query result changes if another transaction inserts a new row matching the
                        criteria between two reads.
                    </p>
                    <div class="mt-3">
                        <span class="badge bg-info">Isolation Level Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6">
        <a href="{% url 'mvcc-visibility' %}" class="text-decoration-none">
            <div class="card demo-card category-isolation hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-isolation">
                        <i class="fas fa-code-branch"></i>
                    </div>
                    <h4 class="demo-title">MVCC & Visibility</h4>
                    <p class="demo-subtitle">Row Versioning</p>
                    <p class="demo-description">
                        Demonstrates PostgreSQL's Multi-Version Concurrency Control and how transactions see consistent
                        snapshots through row versioning with system columns (xmin, xmax, ctid).
                    </p>
                    <div class="mt-3">
                        <span class="badge bg-info">Isolation Level Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>
</div>

<!-- Concurrency & Locking -->
<div class="category-header">
    <h3>
        <span class="category-icon"
            style="background: linear-gradient(135deg, var(--warning) 0%, var(--warning-light) 100%); color: white;">
            <i class="fas fa-lock"></i>
        </span>
        Concurrency Control & Locking
    </h3>
</div>

<div class="row g-4 mb-4">
    <div class="col-md-6">
        <a href="{% url 'row-locking' %}" class="text-decoration-none">
            <div class="card demo-card category-concurrency hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-concurrency">
                        <i class="fas fa-user-lock"></i>
                    </div>
                    <h4 class="demo-title">Row Locking</h4>
                    <p class="demo-subtitle">SELECT FOR UPDATE</p>
                    <p class="demo-description">
                        Simulates concurrent updates to the same seat. Transaction A locks a section row, forcing
                        Transaction B to wait until A completes.
                    </p>
                    <div class="mt-3">
                        <span class="badge bg-warning text-dark">Locking Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6">
        <a href="{% url 'deadlock' %}" class="text-decoration-none">
            <div class="card demo-card category-concurrency hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-concurrency">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h4 class="demo-title">Deadlock Simulation</h4>
                    <p class="demo-subtitle">Circular Wait</p>
                    <p class="demo-description">
                        Intentionally creates a deadlock between two tasks to demonstrate how PostgreSQL detects and
                        resolves deadlock situations.
                    </p>
                    <div class="mt-3">
                        <span class="badge bg-warning text-dark">Deadlock Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>
</div>

<!-- Performance & Optimization -->
<div class="category-header">
    <h3>
        <span class="category-icon" style="background: var(--primary-gradient); color: white;">
            <i class="fas fa-tachometer-alt"></i>
        </span>
        Performance & Optimization
    </h3>
</div>

<div class="row g-4">
    <div class="col-md-6 col-lg-4">
        <a href="{% url 'indexing-benchmark' %}" class="text-decoration-none">
            <div class="card demo-card category-performance hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-performance">
                        <i class="fas fa-search"></i>
                    </div>
                    <h4 class="demo-title">Indexing Benchmark</h4>
                    <p class="demo-subtitle">B-Tree vs Sequential Scan</p>
                    <p class="demo-description">
                        Compares query performance between indexed and non-indexed column searches using EXPLAIN
                        ANALYZE.
                    </p>
                    <div class="mt-3">
                        <span class="badge badge-gradient">Performance Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6 col-lg-4">
        <a href="{% url 'query-optimization' %}" class="text-decoration-none">
            <div class="card demo-card category-performance hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-performance">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h4 class="demo-title">Query Optimizer</h4>
                    <p class="demo-subtitle">Interactive Tool</p>
                    <p class="demo-description">
                        Run custom SQL queries and visualize execution plans, costs, and execution times in real-time.
                    </p>
                    <div class="mt-3">
                        <span class="badge badge-gradient">Interactive Tool</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6 col-lg-4">
        <a href="{% url 'partitioning-demo' %}" class="text-decoration-none">
            <div class="card demo-card category-performance hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-performance">
                        <i class="fas fa-th"></i>
                    </div>
                    <h4 class="demo-title">Table Partitioning</h4>
                    <p class="demo-subtitle">Partition Pruning</p>
                    <p class="demo-description">
                        Benchmarks query performance on partitioned vs non-partitioned tables to demonstrate partition
                        pruning benefits.
                    </p>
                    <div class="mt-3">
                        <span class="badge badge-gradient">Performance Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6 col-lg-4">
        <a href="{% url 'trigger-demo' %}" class="text-decoration-none">
            <div class="card demo-card category-performance hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-performance">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <h4 class="demo-title">Triggers & Procedures</h4>
                    <p class="demo-subtitle">Audit Logging</p>
                    <p class="demo-description">
                        Automatic audit logging using PL/pgSQL triggers. Tracks INSERT, UPDATE, and DELETE operations
                        across multiple tables.
                    </p>
                    <div class="mt-3">
                        <span class="badge badge-gradient">Automation Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6 col-lg-4">
        <a href="{% url 'normalization-demo' %}" class="text-decoration-none">
            <div class="card demo-card category-performance hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-performance">
                        <i class="fas fa-database"></i>
                    </div>
                    <h4 class="demo-title">Normalization vs Denormalization</h4>
                    <p class="demo-subtitle">Materialized Views</p>
                    <p class="demo-description">
                        Compares query performance between normalized tables (with joins) and denormalized data stored
                        in a materialized view.
                    </p>
                    <div class="mt-3">
                        <span class="badge badge-gradient">Performance Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6 col-lg-4">
        <a href="{% url 'monitoring-stats' %}" class="text-decoration-none">
            <div class="card demo-card category-performance hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-performance">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <h4 class="demo-title">Monitoring & Statistics</h4>
                    <p class="demo-subtitle">pg_stat_statements</p>
                    <p class="demo-description">
                        Visualize query performance metrics, latency histograms, and database statistics using
                        PostgreSQL's pg_stat_statements extension.
                    </p>
                    <div class="mt-3">
                        <span class="badge badge-gradient">Monitoring Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>

    <div class="col-md-6 col-lg-4">
        <a href="{% url 'full-text-search' %}" class="text-decoration-none">
            <div class="card demo-card category-performance hover-lift">
                <div class="card-body p-4">
                    <div class="demo-icon icon-performance">
                        <i class="fas fa-search-plus"></i>
                    </div>
                    <h4 class="demo-title">Full-Text Search</h4>
                    <p class="demo-subtitle">GIN Index & TSVECTOR</p>
                    <p class="demo-description">
                        Compare performance and relevance of Full-Text Search (stemming, ranking) vs standard ILIKE pattern matching.
                    </p>
                    <div class="mt-3">
                        <span class="badge badge-gradient">Performance Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>
</div>

<!-- Availability & Reliability -->
<div class="category-header">
    <h3>
        <span class="category-icon" style="background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%); color: white;">
            <i class="fas fa-server"></i>
        </span>
        Availability & Reliability
    </h3>
</div>

<div class="row g-4 mb-4">
    <div class="col-md-6">
        <a href="{% url 'replication-demo' %}" class="text-decoration-none">
            <div class="card demo-card category-isolation hover-lift" style="border-top-color: var(--success);">
                <div class="card-body p-4">
                    <div class="demo-icon icon-isolation" style="background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%);">
                        <i class="fas fa-copy"></i>
                    </div>
                    <h4 class="demo-title">Replication & HA</h4>
                    <p class="demo-subtitle">Master-Slave Replication</p>
                    <p class="demo-description">
                        Demonstrates data consistency tradeoffs and replication lag by writing to a Primary node and reading from an asynchronous Read Replica.
                    </p>
                    <div class="mt-3">
                        <span class="badge bg-success">Availability Demo</span>
                    </div>
                </div>
            </div>
        </a>
    </div>
</div>
{% endblock %}